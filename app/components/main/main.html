<div class="report-header form-group-lg list-group">
  <div class="list-group-item">

    <div class="row-action-primary" ng-if="!main.isPrintView">
      <i class="mdi-editor-insert-chart"></i>
    </div>

    <div class="row-content">
      <h3 class="list-group-item-heading">{{ main.name || 'name' }}</h3>
      <p class="lead">
        {{ main.description || 'description' }}
      </p>
    </div>

  </div>

</div>

<div class="row container-fluid report-tabs">

  <div class="pull-right" ng-show="!main.isPrintView">

    <button class="btn btn-primary btn-sm" tooltip="Refresh result"
        ng-click="main.refresh()"
        ng-disabled="!main.isDirty">
        <i class="mdi-navigation-refresh"></i>
    </button>

    <div class="btn-group">
      <button type="button" class="btn btn-primary btn-sm dropdown-toggle" tooltip="Download SVG"
        data-toggle="dropdown" aria-expanded="false"
        ng-disabled="main.svgs.length === 0">
        <i class="mdi-image-collections"></i> <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href svg-download="#{{svg.id}}" title="{{svg.title}}" ng-repeat="svg in main.svgs">{{svg.title}}</a></li>
      </ul>
    </div>

    <button ng-click="main.togglePreview()" type="button" class="btn btn-primary btn-sm dropdown-toggle" tooltip="Print">
      <i class="mdi-action-print"></i>
    </button>

  </div>

  <div id="print-preview" ng-if="main.isPrintView" >
    <button ng-click="main.togglePreview()" type="button" class="pull-right btn btn-primary btn-sm print-float" tooltip="Print">
      <i class="mdi-action-print"></i>
    </button>

    <div id="result" class="col-xs-12" ng-class="{ dirty: main.isDirty }" report-include files="main.files" data="main.data" refresh="main.ruid" get-svgs="main.svgs">
    </div>
  </div>

  <tabset class="tabs-main" ng-if="!main.isPrintView" >
    <tab heading="Result" active="main.showResult" >
      <div id="result" class="col-xs-12" ng-class="{ dirty: main.isDirty }" report-include files="main.files" data="main.data" refresh="main.ruid" get-svgs="main.svgs">
      </div>
    </tab>
    <tab heading="{{name}}" active="file.active" select="main.refreshTabs(file)" ng-repeat="(name, file) in main.files" ng-if="file.show !== false">
      <div ng-controller="FileCtrl as fileCtrl" ng-init="fileCtrl.mode = {true: 'grid', false: 'code'}[file.type === 'text/tab-separated-values']">

        <div class="btn-toolbar" ng-if="file.table">
          <div class="btn-group btn-group-sm pull-right">
            <button type="button" class="btn btn-primary btn-sm"
                tooltip="Table"
                ng-click="fileCtrl.mode = 'grid'"
                ng-class="fileCtrl.mode === 'grid' ? 'disabled' : ''">
              <i class="mdi-image-grid-on"></i>
            </button>
            <button type="button" class="btn btn-primary btn-sm"
                tooltip="Text"
                ng-click="fileCtrl.mode = 'code'"
                ng-class="fileCtrl.mode === 'code' ? 'disabled' : ''">
              <i class="glyphicon glyphicon-align-left"></i>
            </button>
          </div>
        </div>

        <div class="col-xs-12">

          <div class="grid" ng-show="fileCtrl.mode === 'grid'"
            ui-grid="{ data: file.data }"
            ui-grid-auto-resize></div>

          <div class="code-mirror" ng-if="fileCtrl.mode === 'code' && file.active"
            ng-model="file.content"
            ng-change="main.reparse(file)"
            ui-codemirror="{
              lineNumbers: true,
              lineWrapping : true,
              mode: file.type,
              onLoad : main.codemirrorLoaded
            }"></div>

            <div ng-repeat="error in file.errors" class="alert alert-danger">
              {{error.message}} <span ng-if="error.row">, check row {{error.row+2}}</span>
            </div>

        </div>

      </div>


    </tab>
  </tabset>

</div>
