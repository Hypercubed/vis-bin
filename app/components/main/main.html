<div class="report-header form-group-lg list-group">
  <div class="list-group-item">

    <div class="row-action-primary hidden-print" ng-if="!main.isPrintView">
      <i class="mdi-editor-insert-chart"></i>
    </div>

    <div class="row-content">
      <h3 class="list-group-item-heading">{{ main.dataPackage.name || 'name' }}</h3>
      <p class="lead">
        {{ main.dataPackage.description || 'description' }}
      </p>
    </div>

  </div>

</div>

<div class="row container-fluid report-tabs" ng-class="{ 'print-preview': main.isPrintView }">

  <div class="pull-right">

    <button class="btn btn-primary btn-sm hidden-print" tooltip="Refresh result" ng-if="!main.isPrintView"
        ng-click="main.refresh()"
        ng-disabled="!main.dataPackage.isDirty">
        <i class="mdi-navigation-refresh"></i>
    </button>

    <div class="btn-group hidden-print" ng-if="!main.isPrintView">
      <button type="button" class="btn btn-primary btn-sm dropdown-toggle" tooltip="Download SVG"
        data-toggle="dropdown" aria-expanded="false"
        ng-disabled="main.svgs.length === 0">
        <i class="mdi-image-collections"></i> <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        <li><a href svg-download="#{{svg.id}}" title="{{svg.title}}" ng-repeat="svg in main.svgs">{{svg.title}}</a></li>
      </ul>
    </div>

    <button ng-click="main.togglePreview()" type="button" class="btn btn-primary btn-sm dropdown-toggle hidden-print" tooltip="Print preview">
      <i class="mdi-action-print"></i>
    </button>

  </div>

  <tabset class="tabs-main" ng-if="!main.isPrintView" >
    <tab heading="Result" active="main.showResult" >
    </tab>
    <tab heading="{{file.name}}" ng-repeat="file in main.dataPackage.resources"
        ng-if="file.show !== false"
        active="file.active" select="main.refreshTabs(file)" >
      <div ng-controller="FileCtrl as fileCtrl" ng-init="fileCtrl.mode = {true: 'grid', false: 'code'}[file.type === 'text/tab-separated-values']">

        <div class="btn-toolbar" ng-if="file.table">
          <div class="btn-group btn-group-sm pull-right">
            <button type="button" class="btn btn-primary btn-sm"
                tooltip="Table"
                ng-click="fileCtrl.mode = 'grid'"
                ng-class="fileCtrl.mode === 'grid' ? 'disabled' : ''">
              <i class="mdi-image-grid-on"></i>
            </button>
            <button type="button" class="btn btn-primary btn-sm"
                tooltip="Text"
                ng-click="fileCtrl.mode = 'code'"
                ng-class="fileCtrl.mode === 'code' ? 'disabled' : ''">
              <i class="glyphicon glyphicon-align-left"></i>
            </button>
          </div>
        </div>

        <div class="col-xs-12">

          <div class="grid" ng-show="fileCtrl.mode === 'grid'"
            ui-grid="{ data: file.data }"
            ui-grid-auto-resize></div>

          <div class="code-mirror" ng-if="fileCtrl.mode === 'code' && file.active"
            ng-model="file.content"
            ng-change="main.fileChanged(file)"
            ui-codemirror="{
              lineNumbers: true,
              lineWrapping : false,
              mode: file.type,
              onLoad : main.codemirrorLoaded
            }"></div>

            <div ng-repeat="error in file.errors" class="alert alert-danger">
              {{error.message}} <span ng-if="error.row">, check row {{error.row+2}}</span>
            </div>

        </div>

      </div>


    </tab>
  </tabset>

  <div id="result" class="col-xs-12"
    ng-show="main.showResult || main.isPrintView"
    xxxng-class="{ dirty: main.isDirty }"
    get-svgs="main.svgs">
    <div report-include data="main.dataPackage" refresh-on="report:refresh" print-view="main.isPrintView">
    </div>
  </div>

</div>
